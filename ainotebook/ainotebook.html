<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=no"
  />
  <meta name="theme-color" content="#ffffff" />
  <title>AI Notebook</title>

  <!-- LOST framework styles -->
  <link rel="stylesheet" href="/lost.css" />
  <!-- App styles -->
  <link rel="stylesheet" href="app_ainotebook.css" />
</head>
<body>
  <!-- LostUI will inject header/sidebar/footer. This is our main stage. -->
  <main id="app-stage">
    <section id="notebook-toolbar" aria-label="Notebook toolbar">
      <div class="toolbar-left"></div>
      <div class="toolbar-right">
        <label class="notebook-toolbar-label">
          Default LLM: 
          <input
            id="notebookModelSearch"
            type="search"
            placeholder="Search models"
            class="model-search-input"
          />
          <select id="notebookModelSelect">
            <option value="">None</option>
          </select>
        </label>

        <div class="toolbar-divider"></div>

        <div class="toolbar-run-group">
         <label class="notebook-toolbar-label">
          Run All: 
          <button
            type="button"
            id="runAllBtn"
            class="toolbar-btn run-all-btn"
            title="Run all prompt cells"
            aria-label="Run all prompt cells"
          >
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class=""><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4v16a1 1 0 0 0 1.524 .852l13 -8a1 1 0 0 0 0 -1.704l-13 -8a1 1 0 0 0 -1.524 .852z" /></svg>
          </button>
          <button
            type="button"
            id="stopAllBtn"
            class="toolbar-btn stop-all-btn"
            title="Stop all running cells"
            aria-label="Stop all running cells"
          >
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" class=""><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z" /></svg>
          </button>
        </div>
      </div>
    </section>

    <section id="cells-container" aria-label="Notebook cells"></section>
  </main>

  <!-- Settings dialog for LLM configuration -->
  <dialog id="settingsDialog">
    <form method="dialog" class="settings-form">
      <div class="dialog-header">
        <h2>AI Notebook Settings</h2>
        <p class="dialog-subtitle">
          Configure connections to OpenAI, Claude, and OpenRouter.
        </p>
      </div>
      <div class="dialog-body">
        <section class="settings-section">
          <h3>LLM Connections</h3>
          <p class="settings-hint">
            These settings are stored locally in this browser and are not
            included in shared URLs.
          </p>
          <div id="llmList" class="llm-list"></div>
          <button
            type="button"
            id="addLlmBtn"
            class="btn btn-secondary"
            style="margin-top: 8px"
          >
            + Add provider
          </button>
          <div class="model-cache">
            <div class="model-cache-header">
              <h4>Available models</h4>
              <button type="button" id="refreshModelsBtn" class="btn btn-secondary">
                Refresh list
              </button>
            </div>
            <p class="settings-hint">
              Fetched from your configured providers and cached locally.
            </p>
            <div id="modelCacheStatus" class="model-cache-status"></div>
          </div>
        </section>

        <section class="settings-section">
          <h3>Tips</h3>
          <ul class="settings-tips">
            <li>
              Each prompt cell can override the notebook’s default LLM, or you
              can leave it as “Use notebook default”.
            </li>
            <li>
              In prompts you can reference other cells with
              <code>{{name}}</code>, <code>{{#1}}</code>, or
              <code>{{cell_abc}}</code>.
            </li>
          </ul>
        </section>
      </div>
      <div class="dialog-footer">
        <button type="button" id="settingsCancelBtn" class="btn btn-secondary">
          Cancel
        </button>
        <button type="submit" id="settingsCloseBtn" class="btn btn-primary">
          Save &amp; Close
        </button>
      </div>
    </form>
  </dialog>

  <!-- LOST framework modules -->
  <script type="module" src="/lost.js"></script>
  <script type="module" src="/lost-ui.js"></script>
  <!-- App logic -->
  <script type="module" src="app_ainotebook.js"></script>
</body>
</html>
